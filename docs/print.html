<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>kinder</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="part_1.html"><strong aria-hidden="true">1.</strong> Cluster Creation</a></li><li class="chapter-item expanded "><a href="part_2.html"><strong aria-hidden="true">2.</strong> Repo Structure</a></li><li class="chapter-item expanded "><a href="part_3.html"><strong aria-hidden="true">3.</strong> Cluster Bootstrap</a></li><li class="chapter-item expanded "><a href="part_4.html"><strong aria-hidden="true">4.</strong> Tweet App</a></li><li class="chapter-item expanded "><a href="part_5.html"><strong aria-hidden="true">5.</strong> The Reasone Why</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">kinder</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id=""><a class="header" href="#"><img src="./logo.png" alt="" /></a></h1>
<p>This is a project based on kubernetes, ArgoCD and kustomize. The project serves as a POC to demo the exercise that was provided to me.</p>
<p>TODO: add a graph of everythig</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cluster-creation"><a class="header" href="#cluster-creation">Cluster Creation</a></h1>
<p>This cluster is based on <a href="https://kind.sigs.k8s.io/">kind</a>. The config file that kind consumes, to create the cluster, is located in the root of the repo.</p>
<p>By using this file kind will create a 6 node cluster(1 master + 5 workers).</p>
<p>To create the cluster we run:</p>
<pre><code class="language-bash">git clone https://github.com/diskmanti/kinder.git
cd kinder
kind crete cluster --config=kinder.yaml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="repo-structure"><a class="header" href="#repo-structure">Repo Structure</a></h1>
<p>The whole cluster and the tweet application are installed, managed, deployed and configured using a GitOps approach.
The structure of the repo is as shown below:</p>
<pre><code class="language-bash">kinder/
├── applications
├── bootstrap
├── components
</code></pre>
<h2 id="bootstrap"><a class="header" href="#bootstrap">Bootstrap</a></h2>
<p>The initial cluster bootstrap resides in the <em>bootstrap</em> folder.
In this folder all the yaml files necessary to deploy ArgoCD on the cluster are stored.</p>
<h2 id="applications"><a class="header" href="#applications">Applications</a></h2>
<p>The chosen GitOps approach is the <em>AppOfApps</em> approach. There is a main app called <strong>cluster-config</strong>
which itself manages all the ArgoCD application that configure the different application deployed on the cluster.</p>
<h2 id="components"><a class="header" href="#components">Components</a></h2>
<p>In this folder are stored all the yaml files which are needed to deployed the relevant application on the cluster.
ingress-nginx, cert-manager and the tweet app are all found here in their respective folders. These folders are
referenced by the ArgoCD applications defined in the components folder.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cluster-bootstrap"><a class="header" href="#cluster-bootstrap">Cluster Bootstrap</a></h1>
<p>The cluster is bootstraped using GitOps and the ArgoCD application.</p>
<p>First of all we need to install ArgoCD. All the required files for installing ArgoCD are located in the bootstrap folder.</p>
<p>ArgoCD is installed by running:</p>
<pre><code class="language-bash">kubectl apply -k bootstrap/overlays
</code></pre>
<h2 id="appofapps"><a class="header" href="#appofapps">AppOfApps</a></h2>
<p>All the applications deployed on the cluster are managed using the <a href="https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#app-of-apps">AppOfApps</a> approach.</p>
<p>The cluster configuration is kickstarted by the cluster-config application, which is also named cluster-config.</p>
<p>To create this ArgoCd application we apply the required yamls:</p>
<pre><code class="language-bash">kubectl apply -k applictions/bases
</code></pre>
<p>By creating this application nginx-ingress and cert-manager will be installed and configured in the cluster automatically.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux_tweet_app"><a class="header" href="#linux_tweet_app">Linux_Tweet_App</a></h1>
<p>All the source code for this app is located under linux_tweet_app folder.</p>
<p>This app was build using podman and pushed to dockerhub:</p>
<pre><code class="language-bash">podman build -f /linux_tweet_app/Dockerfile --tag linux_tweet_app
podman tag localhost/linux_tweet_app diskmanti/linux_tweet_app:v1
podman push diskmanti/linux_tweet_app:v1
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-reason-why"><a class="header" href="#the-reason-why">The Reason Why?</a></h1>
<ul>
<li>Kubernetes(Kind) - This is the chosen container orchestration app. Kind was chosen because
is a very lightweight and simple K8S distro to run locally for dev and test purposes.</li>
<li>Automation - The automation tool chosen is ArgoCD. Since the platform were we are going to deploy the
app is K8S the best apprach, based on my POV, is the GitOps way. ArgoCD is one of the most reliable and
battle tested solution to implement GitOps workflow.</li>
<li>Tools - The only tool used is Kustomize. Kustomize is a yaml patch engine that integrates very well with ArgoCD</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
